# üîß –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ2: SQL-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–≤

–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏–∑ –õ–†1: —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–∏ –≤ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã —Ç–µ–ø–µ—Ä—å —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–∞ –≤ PostgreSQL —á–µ—Ä–µ–∑ –Ω–∞–±–æ—Ä SQL-—Å–∫—Ä–∏–ø—Ç–æ–≤. –ó–¥–µ—Å—å –µ—Å—Ç—å –ø–æ–ª–Ω–æ–µ DDL, –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏—è, –ø—Ä–∏–º–µ—Ä—ã DML, –≤—ã–±–æ—Ä–∫–∏ —Å –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –≤ –õ–†2
- –°–æ–±—Ä–∞–Ω–∞ —Å—Ö–µ–º–∞ –ë–î: —Ç–∏–ø—ã ENUM, —Ç–∞–±–ª–∏—Ü—ã, –ø–µ—Ä–≤–∏—á–Ω—ã–µ/–≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏, UNIQUE, CHECK –∏ –∏–Ω–¥–µ–∫—Å—ã.
- –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç—Ä–∞–∂–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏ (–∫–ª–∏–µ–Ω—Ç—ã, –º–∞—Å—Ç–µ—Ä–∞, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Å–ª–æ—Ç—ã, —Ç–∏–∫–µ—Ç—ã, –∑–∞–ø–∏—Å–∏).
- –û–ø–∏—Å–∞–Ω —Å–∫–≤–æ–∑–Ω–æ–π DML-—Å—Ü–µ–Ω–∞—Ä–∏–π: —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞, –±—Ä–æ–Ω—å —Å–ª–æ—Ç–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤, —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ–º —Å–ª–æ—Ç–æ–≤.
- –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞–º–∏, HAVING, CASE/FILTER –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ JOIN.
- –°–æ–∑–¥–∞–Ω—ã 3 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏: –ø–æ —Ü–µ–Ω—Ç—Ä–∞–º, –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º –∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –º–∞—Å—Ç–µ—Ä–æ–≤.

## –°–æ—Å—Ç–∞–≤ —Ñ–∞–π–ª–æ–≤
- `schema.sql` ‚Äî –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏.
- `seed.sql` ‚Äî –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ –∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
- `dml_examples.sql` ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä INSERT+UPDATE+DELETE —Å CTE.
- `queries.sql` ‚Äî –≤—ã–±–æ—Ä–∫–∏ —Å –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
- `views.sql` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –¥–ª—è —É–¥–æ–±–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

## –¢–µ–æ—Ä–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- **DDL:** `CREATE TYPE` –¥–ª—è ENUM (—Ä–æ–ª–∏, —Å—Ç–∞—Ç—É—Å—ã, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã), `CREATE TABLE`, `DROP ... CASCADE` –¥–ª—è –æ—á–∏—Å—Ç–∫–∏. –ü–æ–ª—è `BIGSERIAL` —Å –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º, `DEFAULT`, `NOT NULL`.
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:** `PRIMARY KEY` –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, `UNIQUE` (—Ç–µ–ª–µ—Ñ–æ–Ω, email, –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏), `FOREIGN KEY` –¥–ª—è —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏, `CHECK` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ (—É—Ä–æ–≤–µ–Ω—å –Ω–∞–≤—ã–∫–∞, –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ —Å–ª–æ—Ç–∞).
- **–ò–Ω–¥–µ–∫—Å—ã:** —Å–æ–∑–¥–∞—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é –ø–æ–¥ —á–∞—Å—Ç—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã/—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (`device_type_id`, `status`, `center_id, is_booked, starts_at`), —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —è–≤–Ω—ã–π –≤—ã–±–æ—Ä –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫.
- **DML –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:** `BEGIN/COMMIT`, `INSERT/UPDATE/DELETE`. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è CTE (`WITH`) –¥–ª—è –ø–æ—à–∞–≥–æ–≤–æ–π –ª–æ–≥–∏–∫–∏: –Ω–∞–π—Ç–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–∞, –≤—Å—Ç–∞–≤–∏—Ç—å —Ç–∏–∫–µ—Ç, –ø–æ–¥–æ–±—Ä–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–π —Å–ª–æ—Ç, –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –∏ –æ—Ç–º–µ—Ç–∏—Ç—å —Å–ª–æ—Ç –∑–∞–Ω—è—Ç—ã–º.
- **–ê–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ —Ñ–∏–ª—å—Ç—Ä—ã:** `GROUP BY`, –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ `COUNT/SUM/AVG`, `HAVING`, `FILTER` –¥–ª—è —É—Å–ª–æ–≤–Ω—ã—Ö –ø–æ–¥—Å—á—ë—Ç–æ–≤, `CASE` –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è ¬´–≤–µ—Å–∞¬ª –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤.
- **JOIN:** –∏ INNER, –∏ LEFT JOIN –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏ –ø–æ–¥—Å—á—ë—Ç–æ–≤ –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–≤—è–∑–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã –±–µ–∑ –∑–∞–ø–∏—Å–∏).
- **–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:** `CREATE OR REPLACE VIEW` –∫–∞–∫ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã ‚Äî —Å–≤–æ–¥–∫–∞ –ø–æ —Ü–µ–Ω—Ç—Ä–∞–º, –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–æ–≤ —Å –≤—ã—á–∏—Å–ª—è–µ–º—ã–º–∏ –ø–æ–ª—è–º–∏.

## –ö–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å (psql)
```bash
psql -f lab-02/schema.sql
psql -f lab-02/seed.sql
psql -f lab-02/views.sql
psql -f lab-02/dml_examples.sql    # –ø—Ä–∏–º–µ—Ä —Å–∫–≤–æ–∑–Ω—ã—Ö DML-–æ–ø–µ—Ä–∞—Ü–∏–π
psql -f lab-02/queries.sql         # –ø—Ä–∏–º–µ—Ä—ã –≤—ã–±–æ—Ä–æ–∫ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–π
```

## –ß—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ —Å–¥–µ–ª–∞–Ω–æ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö
- `schema.sql`: —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –æ–±—ä–µ–∫—Ç—ã –∫–∞—Å–∫–∞–¥–Ω–æ, —Å–æ–∑–¥–∞—ë—Ç ENUM-—Ç–∏–ø–æ–≤, —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ü–µ–Ω—Ç—Ä–æ–≤, –º–∞—Å—Ç–µ—Ä–æ–≤, —É—Å—Ç—Ä–æ–π—Å—Ç–≤, —Å–ª–æ—Ç–æ–≤, —Ç–∏–∫–µ—Ç–æ–≤ –∏ –∑–∞–ø–∏—Å–µ–π. –î–æ–±–∞–≤–ª—è–µ—Ç –∫–ª—é—á–∏, UNIQUE, CHECK, –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —Ç–∏–ø–∏—á–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã.
- `seed.sql`: –≤—Å—Ç–∞–≤–ª—è–µ—Ç –±–∞–∑–æ–≤—ã–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏. –î–∞–Ω–Ω—ã–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã –ø–æ –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–∞–º (—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –∫–ª–∏–µ–Ω—Ç–∞–º –∏ –º–æ–¥–µ–ª—è–º, —Å–ª–æ—Ç—ã –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –º–∞—Å—Ç–µ—Ä–∞–º, —Ç–∏–∫–µ—Ç—ã –∏ –∑–∞–ø–∏—Å–∏ ‚Äî –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º –∏ —Å–ª–æ—Ç–∞–º).
- `dml_examples.sql`: —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π —Ç–∏–∫–µ—Ç, –Ω–∞—Ö–æ–¥–∏—Ç —Å–≤–æ–±–æ–¥–Ω—ã–π —Å–ª–æ—Ç, –±—Ä–æ–Ω–∏—Ä—É–µ—Ç –µ–≥–æ, –∑–∞—Ç–µ–º –ø—Ä–∏–º–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞—è–≤–∫–∏, –∏ –ø—Ä–∏–º–µ—Ä —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–º–µ–Ω—ë–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ–º —Å–ª–æ—Ç–æ–≤.
- `queries.sql`: –Ω–∞–±–æ—Ä SELECT —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞–º–∏ (–Ω–∞–≥—Ä—É–∑–∫–∞ –ø–æ —Ü–µ–Ω—Ç—Ä–∞–º, —Å—Ä–µ–¥–Ω—è—è –∑–∞–Ω—è—Ç–æ—Å—Ç—å –º–∞—Å—Ç–µ—Ä–æ–≤, –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–æ–¥–µ–ª–∏, –∫–ª–∏–µ–Ω—Ç—ã —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ).
- `views.sql`: —Ç—Ä–∏ –≤—å—é—Ö–∏ ‚Äî —Å–≤–æ–¥–∫–∞ –ø–æ —Ü–µ–Ω—Ç—Ä–∞–º (–∑–∞–Ω—è—Ç–æ—Å—Ç—å —Å–ª–æ—Ç–æ–≤, –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã), –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ/–≤–µ—Å —Ç–∏–∫–µ—Ç–æ–≤, –∑–∞–∫—Ä—ã—Ç—ã–µ/–æ—Ç–∫—Ä—ã—Ç—ã–µ), —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–æ–≤ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —á–∏—Å—Ç–æ–π PostgreSQL –∏ –æ–ø–∏—Ä–∞—é—Ç—Å—è –Ω–∞ –º–æ–¥–µ–ª—å –∏–∑ –õ–†1; –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
